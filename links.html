<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>قائمة الموضوعات</title>
    <!-- <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    /> -->
    <style>
      /*
      @font-face {
    font-family: 'DIN Next LT Arabic';
    src: url('fonts/din-next-lt-arabic-regular.woff2') format('woff2'),
         url('fonts/din-next-lt-arabic-regular.woff') format('woff');
    font-weight: 400;
    font-style: normal;
  }

  @font-face {
    font-family: 'DIN Next LT Arabic';
    src: url('fonts/din-next-lt-arabic-bold.woff2') format('woff2'),
         url('fonts/din-next-lt-arabic-bold.woff') format('woff');
    font-weight: 700;
    font-style: normal;
  }*/
  

/*  body {
    font-family: 'DIN Next LT Arabic', sans-serif;
    direction: rtl;
  }*/
      :root {
        --c-header: #388494;
        --c-bg-1: #358091;
        --c-bg-2: #336c87;
        --c-divider: rgba(255, 255, 255, 0.22);
        --c-text: rgba(255, 255, 255, 0.92);
        --c-text-dim: rgba(255, 255, 255, 0.75);
        --c-active-bg: #2fb39a;
        --c-hover-bg: rgba(255, 255, 255, 0.08);
        --c-hover-strip: #2aa6a6;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        /*font-family: "Tajawal", Tahoma, Arial, sans-serif;*/
        font-family: 'DIN Next LT Arabic', sans-serif;
        direction: rtl;
        margin: 0;
        color: var(--c-text);
        background: linear-gradient(180deg, var(--c-bg-1), var(--c-bg-2));
        user-select: none;
      }

      /* Header */
      .topbar {
        position: sticky;
        top: 0;
        z-index: 5;
        height: 56px;
        display: grid;
        grid-template-columns: 40px 1fr 40px;
        align-items: center;
        padding: 0 8px;
        background: var(--c-header);
        color: #fff;
        border-bottom: 1px solid rgba(0, 0, 0, 0.15);
      }
      .btn {
        width: 36px;
        height: 36px;
        display: grid;
        place-items: center;
        border: none;
        background: transparent;
        color: #fff;
        cursor: pointer;
        border-radius: 8px;
      }
      .btn:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      .title {
        text-align: center;
        font-weight: 700;
        letter-spacing: 0.2px;
        white-space: nowrap;
      }

      .scroll {
        position: relative;
        height: calc(100vh - 56px);
        overflow: auto;
        padding: 8px 6px 24px;
      }
      .scroll::-webkit-scrollbar {
        width: 10px;
      }
      .scroll::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.25);
        border-radius: 8px;
        border: 2px solid transparent;
        background-clip: padding-box;
      }

      /* Section (accordion) */
      .section {
        margin: 10px 6px 2px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 2px;
        background: rgba(255, 255, 255, 0.04);
        overflow: hidden;
      }
      .section-header {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        font-weight: 700;
        color: #fff;
        cursor: pointer;
        position: relative;
        transition: background 0.15s ease, color 0.15s ease;
      }
      .section-header:hover {
        background: var(--c-hover-bg);
      }
      .section-header::before {
        content: "";
        position: absolute;
        inset-inline-start: -2px;
        top: 50%;
        width: 6px;
        height: 0;
        border-radius: 6px;
        background: transparent;
        transform: translateY(-50%);
        transition: height 0.12s ease, background 0.12s ease;
      }
      .section-header:hover::before {
        height: 60%;
        background: var(--c-hover-strip);
      }
      .section-header .label {
        flex: 1;
      }
      .section-header .chev {
        width: 18px;
        height: 18px;
        transform: rotate(180deg); /* السهم يشير لليمين */
        transition: transform 0.15s ease;
      }
      .section-header .icon {
        width: 18px;
        height: 18px;
       
      }
      .section.open .section-header .chev {
        transform: rotate(90deg); /* السهم يشير لأسفل عند الفتح */
      }

      /* Items */
      .items {
        background: transparent;
        display: block;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
      }
      .section.open .items {
        max-height: 2000px; /* قيمة كبيرة لضمان ظهور جميع العناصر */
        transition: max-height 0.5s ease-in;
      }
      .item {
        position: relative;
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        margin: 0;
        text-decoration: none;
        color: var(--c-text);
        border-bottom: 1px solid var(--c-divider);
        border-radius: 0;
        transition: background 0.15s ease, color 0.15s ease;
      }
      .item .label {
        flex: 1;
      }
      .item .icon {
        width: 18px;
        height: 18px;
        color: #fff;
      }
      .item::before {
        content: "";
        position: absolute;
        inset-inline-start: -2px;
        top: 50%;
        width: 6px;
        height: 0;
        border-radius: 6px;
        background: transparent;
        transform: translateY(-50%);
        transition: height 0.12s ease, background 0.12s ease;
      }
      .item:hover {
        background: var(--c-hover-bg);
      }
      .item:hover::before {
        height: 60%;
        background: var(--c-hover-strip);
      }
      .item.active {
        background: var(--c-active-bg);
        color: #0a2a32;
        font-weight: 700;
      }
      .item.active .icon {
        color: #0a2a32;
      }
      .section-header.active {
  background: var(--c-active-bg);
  color: #0a2a32;
  font-weight: 700;
}
.section-header.active .icon,
.section-header.active .chev {
  color: #0a2a32;
}

    </style>
  </head>
  <body>
    <!-- HEADER -->
    <div class="topbar">
      <!-- Hamburger (no interaction) -->
      <button class="btn" aria-label="قائمة">
        <svg
          class="icon"
          viewBox="0 0 24 24"
          width="22"
          height="22"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        >
          <path d="M3 6h18M3 12h18M3 18h18" />
        </svg>
      </button>

      <div class="title">قائمة الموضوعات</div>

      <!-- Close -->
      <button class="btn" id="btnClose" aria-label="إغلاق القائمة">
        <svg
          class="icon"
          viewBox="0 0 24 24"
          width="22"
          height="22"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        >
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- LIST -->
    <div class="scroll" id="listRoot"></div>

    <script>
      // خريطة ربط المفاتيح برقم الشاشة (عدّل الأرقام حسب تطبيقك)
const keyToScreen = {
  intro_unit: 1,
  unit_goals: 2,
  quality_definition: 3,
  self_assess_1: 4,
  quality_expectations: 5,
  quality_examples: 6,
  self_assess_2: 7,
  intro_service_success: 8,
  business_success: 9,
  word_of_mouth: 10,
  interactive_activity: 11,
  unit_summary: 12,
  self_assess_4: 13,
 /* interactive_activity: 14,
  unit_summary: 15,
  self_assess_4: 16,*/
};

      // تقسيم القائمة إلى مجموعتين مع العناوين والعناصر المناسبة
    const groups = [
/*  {
    key: "intro_program",
    title: "مدخل البرنامج",
    items: [
      { key: "intro_unit", label: "مقدمة البرنامج" },
      { key: "unit_goals", label: "أهداف البرنامج" }
    ]
  },*/
  {
    key: "first_unit",
    title: "الوحدة الثالثة",
    items: [
      { key: "intro_unit", label: "مقدمة الوحدة" },
      { key: "unit_goals", label: "أهداف الوحدة" }
    ]
  },
  { key: "quality_definition", title: "مفهوم مزيج التسويق للخدمات ", items: [] },
  {
    key: "customer_service_role",
    title: "العناصر السبعة لمزيج التسويق للخدمات",
    items: [
      { key: "self_assess_1", label: "مقدمة" },
      { key: "quality_expectations", label: "العناصر السبعة لمزيج التسويق للخدمات" },
      { key: "quality_examples", label: "تطبيق العناصر السبعة لمزيج التسويق على الخدمات السياحية" },
     /* { key: "quality_components", label: "تعزيز قيمة العلامة التجارية" },
      { key: "self_assess_2", label: "أمثلة لتطبيقات خدمة العملاء في  السياحة" },

      { key: "business_success", label: "طرق تطوير خدمة العملاء في السياحة" }*/
    ]
  },
    { key: "self_assess_2", title: "الأثر المالي لخدمة العملاء ", items: [] },
  {
    key: "customer_service_role",
    title: "الأثر السلوكي لخدمة العملاء ",
    items: [
      { key: "intro_service_success", label: "الأثر السلوكي لخدمة العملاء  " },
      { key: "business_success", label: "التبويب الأفقي" },
      /*{ key: "business_success", label: "تطبيقات الاقتصاد الخدمي في قطاع السياحة" },
      { key: "self_assess_3", label: "استدلالات رقمية على دور الاقتصاد الخدمي في السياحة" },*/


     /* { key: "self_assess_2", label: "أمثلة لتطبيقات خدمة العملاء في  السياحة" },

      { key: "business_success", label: "طرق تطوير خدمة العملاء في السياحة" }*/
    ]
  },

  { key: "word_of_mouth", title: "تقييم ذاتي", items: [] },
  { key: "interactive_activity", title: "نشاط تفاعلي", items: [] },
  { key: "unit_summary", title: "ملخص الوحدة", items: [] },
  { key: "self_assess_4", title: "تمارين الوحدة", items: [] }


];

      const root = document.getElementById("listRoot");

      function svgChevron() {
        return `
  <svg class="chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <path d="M9 6l6 6-6 6"/>
  </svg>`;
      }

      function svgLayers() {
        return `
  <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <path d="M12 7l7.5 3.75L12 14.5 4.5 10.75 12 7z"/>
    <path d="M19.5 12.75L12 16.5 4.5 12.75M19.5 16.5L12 20.25 4.5 16.5"/>
  </svg>`;
      }

      function makeItem(obj) {
        const a = document.createElement("a");
        a.href = "#";
        a.className = "item";
        a.dataset.key = obj.key;
        a.innerHTML = `<span class="label">${obj.label}</span>${svgLayers()}`;
        a.addEventListener("click", function (ev) {
          ev.preventDefault();
          document
            .querySelectorAll(".item")
            .forEach((it) => it.classList.remove("active"));
          a.classList.add("active");
          try {
            parent.postMessage({ type: "extMenu:navigate", key: obj.key }, "*");
          } catch (e) {}
          // أرسل المفتاح ورقم الشاشة (إن وجد) للإطار الأب
          try {
            parent.postMessage({ type: "extMenu:navigate", key: obj.key, screen: keyToScreen[obj.key] ?? null }, "*");
          } catch (e) {}
          try {
            parent.postMessage("extMenu:close", "*");
          } catch (e) {}
        });
        return a;
      }

// تحديث دالة build
     function build() {
  const root = document.getElementById("listRoot");
  if (!root) return;

  root.innerHTML = ""; // تنظيف المحتوى القديم

   groups.forEach((group) => {
    // اعرض المجموعة اذا كان لها عنوان حتى لو كانت items فارغة
    if (!group?.title && !group?.items?.length) return;

    const sec = document.createElement("div");
    sec.className = "section";

    // ...existing code...
const head = document.createElement("div");
head.className = "section-header";
// إذا المجموعة فارغة استخدم أيقونة الطبقات مثل العناصر الفرعية، وإلا السهم
const iconHtml = (group.items && group.items.length) ? svgChevron() : svgLayers();
head.innerHTML = `<span class="label">${group.title}</span>${iconHtml}`;
// إذا فيه مفتاح ضعها في dataset لتعامل كعنوان قابل للنقل
if (group.key) head.dataset.key = group.key;

head.addEventListener("click", (e) => {
  e.preventDefault();
  const isOpen = sec.classList.contains("open");

  // إذا المجموعة تحتوي على عناصر فرعية، فقط افتح أو أغلق القسم بدون إغلاق القائمة
  if (group.items && group.items.length) {
    if (isOpen) {
      sec.classList.remove("open");
    } else {
      // إغلاق كل الأقسام الأخرى
      document.querySelectorAll(".section").forEach((s) => {
        s.classList.remove("open");
      });
      sec.classList.add("open");
    }

    // إزالة حالة النشط من العناصر والعناوين الأخرى
    document.querySelectorAll(".item, .section-header").forEach((it) =>
      it.classList.remove("active")
    );

    // لا ترسل رسالة إغلاق القائمة هنا للسماح بالتنقل داخل القائمة
  } else if (group.key) {
    // إذا لا توجد عناصر فرعية، اعتبر العنوان رابطًا: ضع active، وأرسل رسالة للتنقل ثم اغلق القائمة
    document.querySelectorAll(".item, .section-header").forEach((it) =>
      it.classList.remove("active")
    );
    head.classList.add("active");
    try {
      parent.postMessage({ type: "extMenu:navigate", key: group.key, screen: keyToScreen[group.key] ?? null }, "*");
    } catch (e) {}
    try {
      parent.postMessage("extMenu:close", "*");
    } catch (e) {}
  }
});

sec.appendChild(head);


    const wrap = document.createElement("div");
    wrap.className = "items";

    if (group.items && group.items.length) {
      group.items.forEach((item) => {
        wrap.appendChild(makeItem(item));
      });
    }

    sec.appendChild(wrap);
    root.appendChild(sec);
  });
}
     
      // تنفيذ الدالة عند تحميل الصفحة
     
 document.addEventListener("DOMContentLoaded", function () {
        build();

        // إعداد زر الإغلاق ليعمل كالنقر خارج القائمة
        const btn = document.getElementById("btnClose");
        if (btn) {
          btn.addEventListener("click", function (ev) {
            ev.preventDefault();
            // إغلاق كل الأقسام وإزالة حالة العناصر النشطة
            document.querySelectorAll(".section").forEach((s) => s.classList.remove("open"));
            document.querySelectorAll(".item").forEach((it) => it.classList.remove("active"));
            // إبلاغ الإطار الخارجي
            try {
              parent.postMessage("extMenu:close", "*");
            } catch (e) {}
          });
        }
      });

    </script>
  </body>
</html>
